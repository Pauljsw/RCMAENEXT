# cfgs/custom_models/rmae_voxelnext_clean_pretraining.yaml
#
# π― Clean R-MAE + VoxelNeXt Pretraining Config
# κ³µμ‹ R-MAE GitHub μ½”λ“ μ¤νƒ€μΌλ΅ λ‹¨μν™”

CLASS_NAMES: ['dumptruck', 'excavator', 'grader', 'roller']

DATA_CONFIG:
    _BASE_CONFIG_: cfgs/dataset_configs/custom_dataset_isarc.yaml
    
    # π“ Pretrainingμ© μµμ†ν•μ augmentation (κ³µμ‹ μ¤νƒ€μΌ)
    DATA_AUGMENTOR:
        DISABLE_AUG_LIST: ['gt_sampling']  # Pretrainingμ—λ” GT sampling λ¶ν•„μ”
        AUG_CONFIG_LIST:
            - NAME: random_world_flip
              ALONG_AXIS_LIST: ['x']
            - NAME: random_world_scaling
              WORLD_SCALE_RANGE: [0.98, 1.02]  # μµμ†ν•μ scaling

MODEL:
    NAME: RMAEVoxelNeXtClean  # μƒλ΅μ΄ clean detector
    
    VFE:
        NAME: MeanVFE

    BACKBONE_3D:
        NAME: RadialMAEVoxelNeXtClean  # μƒλ΅μ΄ clean backbone
        
        # π“ κ³µμ‹ R-MAE νλΌλ―Έν„° (λ‹¨μν™”)
        MASKED_RATIO: 0.8      # κ³µμ‹ κΈ°λ³Έκ°’
        ANGULAR_RANGE: 1       # κ³µμ‹ κΈ°λ³Έκ°’: 1λ„
        PRETRAINING: True      # Pretraining λ¨λ“
    
    # π“ Pretrainingμ—λ” DENSE_HEAD μ—†μ (κ³µμ‹ μ¤νƒ€μΌ)
    # Detection headλ” fine-tuningμ—μ„λ§ μ‚¬μ©

    POST_PROCESSING:
        RECALL_THRESH_LIST: [0.3, 0.5, 0.7]
        EVAL_METRIC: kitti

# π“ κ³µμ‹ R-MAE μ¤νƒ€μΌμ μµμ ν™” μ„¤μ •
OPTIMIZATION:
    BATCH_SIZE_PER_GPU: 4     # κ³µμ‹κ³Ό λ™μΌ
    NUM_EPOCHS: 30            # κ³µμ‹κ³Ό λ™μΌ

    OPTIMIZER: adam_onecycle  # κ³µμ‹κ³Ό λ™μΌ
    LR: 0.003                 # κ³µμ‹κ³Ό λ™μΌ
    WEIGHT_DECAY: 0.01        # κ³µμ‹κ³Ό λ™μΌ
    MOMENTUM: 0.9

    MOMS: [0.95, 0.85]        # κ³µμ‹κ³Ό λ™μΌ
    PCT_START: 0.4
    DIV_FACTOR: 10
    DECAY_STEP_LIST: [20, 25]
    LR_DECAY: 0.1
    LR_CLIP: 0.0000001

    LR_WARMUP: False          # κ³µμ‹κ³Ό λ™μΌ
    WARMUP_EPOCH: 1

    GRAD_NORM_CLIP: 10        # κ³µμ‹κ³Ό λ™μΌ